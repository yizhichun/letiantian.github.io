<!doctype html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>






<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.1" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="乐天笔记, 樂天笔记, 编程" />





  <link rel="alternate" href="/atom.xml" title="樂天笔记" type="application/atom+xml" />




  <link rel="shortcut icon" type="image/x-icon" href="/content/images/favicon.ico?v=5.1.1" />






<meta property="og:type" content="website">
<meta property="og:title" content="樂天笔记">
<meta property="og:url" content="http://www.letiantian.me/page/6/index.html">
<meta property="og:site_name" content="樂天笔记">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="樂天笔记">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":0,"b2t":false,"scrollpercent":false},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://www.letiantian.me/page/6/"/>





  <title>樂天笔记</title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  <img class='bg-image' src="/content/images/bg.jpg" />

  







  <script type="text/javascript">
    (function() {
      var hm = document.createElement("script");
      hm.src = "//tajs.qq.com/stats?sId=62535551";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>









  
  
    
  

  <div class="container sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">樂天笔记</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-topics">
          <a href="/topics" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-flask"></i> <br />
            
            专题
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://www.letiantian.me/2015-01-14-learn-mybatis-from-scratch-01/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Letian">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/content/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="樂天笔记">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2015-01-14-learn-mybatis-from-scratch-01/" itemprop="url">浅入浅出MyBatis(01)：查询id为1的用户的信息</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2015-01-14T13:25:52+08:00">
                January 14th 2015
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>2015-01-14</p>
<p><strong>该文章是《专题：浅入浅出MyBatis》系列文章的一篇。<a href="/topic-learn-mybatis-from-scratch">点击进入该专题目录</a></strong></p>
<p>工具与环境：Intellij IDEA 14，JDK 1.7，MyBatis 3.2，MySQL 5.5。</p>
<h2 id="数据库设计"><a href="#数据库设计" class="headerlink" title="数据库设计"></a>数据库设计</h2><p>数据库使用MySQL，新建数据库<code>blog_db</code>，然后建立表：</p>
<pre><code>CREATE  TABLE `blog_db`.`user` (
  `id` INT NOT NULL AUTO_INCREMENT ,
  `name` VARCHAR(45) NOT NULL ,
  `email` VARCHAR(45) NOT NULL ,
  `password` VARCHAR(45) NOT NULL ,
  PRIMARY KEY (`id`) )
ENGINE = InnoDB
DEFAULT CHARACTER SET = utf8
COLLATE = utf8_general_ci;

ALTER TABLE `blog_db`.`user` 
ADD UNIQUE INDEX `name_unique` (`name` ASC) ;

INSERT INTO `blog_db`.`user` (`name`, `email`, `password`) VALUES (&#39;letian&#39;, &#39;letian@111.com&#39;, &#39;123&#39;);

INSERT INTO `blog_db`.`user` ( `name`, `email`, `password`) VALUES (&#39;xiaosi&#39;, &#39;xiaosi@111.com&#39;, &#39;123&#39;);
</code></pre><p>user表中数据如下：</p>
<pre><code>mysql&gt; select * from user;
+----+--------+----------------+----------+
| id | name   | email          | password |
+----+--------+----------------+----------+
|  1 | letian | letian@111.com | 123      |
|  2 | xiaosi | xiaosi@111.com | 123      |
+----+--------+----------------+----------+
2 rows in set (0.00 sec)
</code></pre><h2 id="源码结构"><a href="#源码结构" class="headerlink" title="源码结构"></a>源码结构</h2><p><img src="/content/images/2015/01/2015-01-14-mybatis-01.png" alt=""></p>
<p>在项目下的lib目录下放入需要的两个jar。这里可以使用maven。File -&gt; Project Structure -&gt; Modules -&gt; Dependencies -&gt; 绿色的“+” -&gt; Library… -&gt; From Maven，筛选所需要的jar即可。</p>
<p>在src目录下存放我们编写的代码。</p>
<h2 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h2><h3 id="mybatis的配置文件mybatis-config-xml"><a href="#mybatis的配置文件mybatis-config-xml" class="headerlink" title="mybatis的配置文件mybatis-config.xml"></a>mybatis的配置文件mybatis-config.xml</h3><pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;
&lt;!DOCTYPE configuration
        PUBLIC &quot;-//mybatis.org//DTD Config 3.0//EN&quot;
        &quot;http://mybatis.org/dtd/mybatis-3-config.dtd&quot;&gt;
&lt;configuration&gt;
    &lt;environments default=&quot;development&quot;&gt;
        &lt;environment id=&quot;development&quot;&gt;
            &lt;transactionManager type=&quot;JDBC&quot;/&gt;
            &lt;dataSource type=&quot;POOLED&quot;&gt;
                &lt;property name=&quot;driver&quot; value=&quot;com.mysql.jdbc.Driver&quot;/&gt;
                &lt;property name=&quot;url&quot; value=&quot;jdbc:mysql://127.0.0.1:3306/blog_db?useUnicode=true&amp;amp;characterEncoding=utf8&quot;/&gt;
                &lt;property name=&quot;username&quot; value=&quot;root&quot;/&gt;
                &lt;property name=&quot;password&quot; value=&quot;123&quot;/&gt;
            &lt;/dataSource&gt;
        &lt;/environment&gt;
    &lt;/environments&gt;
    &lt;mappers&gt;
        &lt;mapper resource=&quot;letian/mybatis/mapper/UserMapper.xml&quot;/&gt;
    &lt;/mappers&gt;
&lt;/configuration&gt;
</code></pre><p>在<code>&lt;environment&gt;</code>中配置了<code>&lt;dataSource&gt;</code>。上面的配置中，在<code>&lt;mappers&gt;</code>下只引入了一个<code>mapper</code>文件，具体是<code>letian.mybatis.mapper.</code>下的<code>UserMapper.xml</code>，<code>resource</code>属性的值是路径。</p>
<h3 id="letian-mybatis-bean下的User-java"><a href="#letian-mybatis-bean下的User-java" class="headerlink" title="letian.mybatis.bean下的User.java"></a>letian.mybatis.bean下的User.java</h3><pre><code>package letian.mybatis.bean;


public class User {

    private int id;
    private String name;
    private String email;
    private String password;

    public void setId(int id) {
        this.id = id;
    }

    public void setName(String name) {
        this.name = name;
    }

    public void setEmail(String email) {
        this.email = email;
    }

    public void setPassword(String password) {
        this.password = password;
    }

    public int getId() {
        return id;
    }

    public String getName() {
        return name;
    }

    public String getEmail() {
        return email;
    }

    public String getPassword() {
        return password;
    }

    @Override
    public String toString() {
        return &quot;User{&quot; +
                &quot;id=&quot; + id +
                &quot;, name=&#39;&quot; + name + &#39;\&#39;&#39; +
                &quot;, email=&#39;&quot; + email + &#39;\&#39;&#39; +
                &quot;, password=&#39;&quot; + password + &#39;\&#39;&#39; +
                &#39;}&#39;;
    }
}
</code></pre><p>注意，setter和getter方法、toString可以使用IDEA生成，具体做法是在编辑器右击，选择“Generate…”，在弹出窗口选择要生成的方法即可。</p>
<p>更需要注意的是，User类的四个字段的名字和数据库中user表的各个对应的字段名称完全相同。</p>
<h3 id="letian-mybatis-dao下的UserMapper-java"><a href="#letian-mybatis-dao下的UserMapper-java" class="headerlink" title="letian.mybatis.dao下的UserMapper.java"></a>letian.mybatis.dao下的UserMapper.java</h3><pre><code>package letian.mybatis.dao;

import letian.mybatis.bean.User;

public interface UserMapper {

    User findById(int id);
}
</code></pre><p><code>UserMapper</code>是一个接口，其接口名称以及定义的方法名称<code>findById</code>是能与<code>letian/mybatis/mapper/UserMapper.xml</code>中的配置对应起来的。</p>
<h3 id="letian-mybatis-mapper下的UserMapper-xml"><a href="#letian-mybatis-mapper下的UserMapper-xml" class="headerlink" title="letian.mybatis.mapper下的UserMapper.xml"></a>letian.mybatis.mapper下的UserMapper.xml</h3><pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;
&lt;!DOCTYPE mapper PUBLIC
        &quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;
        &quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;&gt;

&lt;!--这块等于dao接口的实现  namespace必须和接口的类路径一样--&gt;
&lt;mapper namespace=&quot;letian.mybatis.dao.UserMapper&quot;&gt;
    &lt;!-- findById必须和接口中的方法名一样  返回一个User  就是刚才的别名  如果不弄别名要连类路径一起写 麻烦--&gt;
    &lt;select id=&quot;findById&quot; parameterType=&quot;HashMap&quot; resultType=&quot;letian.mybatis.bean.User&quot;&gt;
        select
        * from blog_db.user where id=#{id}
    &lt;/select&gt;
&lt;/mapper&gt;
</code></pre><p><code>&lt;Mapper&gt;</code>的<code>namespace</code>是<code>letian.mybatis.dao.UserMapper</code>接口。唯一的一个<code>&lt;select&gt;</code>的id是<code>findById</code>，也是在<code>letian.mybatis.dao.UserMapper</code>接口定义的一个方法。<code>&lt;select&gt;</code>的值是一个select语句，其中<code>#{id}</code>对应方法<code>findById</code>的参数<code>int id</code>，执行select查询后，返回的类型是<code>letian.mybatis.bean.User</code>。</p>
<p>此处的<code>#{id}</code>个人有些疑问，具体请见<a href="/2015-01-14-learn-mybatis-from-scratch-11">浅入浅出MyBatis(11)：动态SQL</a>。</p>
<h3 id="Main-java"><a href="#Main-java" class="headerlink" title="Main.java"></a>Main.java</h3><pre><code>import java.io.IOException;

import org.apache.ibatis.io.Resources;
import org.apache.ibatis.session.SqlSession;
import org.apache.ibatis.session.SqlSessionFactory;
import org.apache.ibatis.session.SqlSessionFactoryBuilder;

import letian.mybatis.bean.User;
import letian.mybatis.dao.UserMapper;


public class Main {

    public static void main(String[] args) throws IOException {

        SqlSessionFactory sessionFactory;
        sessionFactory = new SqlSessionFactoryBuilder()
                .build(Resources.getResourceAsReader(&quot;mybatis-config.xml&quot;));

        SqlSession sqlSession = sessionFactory.openSession();
        UserMapper userMapper = sqlSession.getMapper(UserMapper.class);

        User user = userMapper.findById(1);
        System.out.println(user);

    }
}
</code></pre><h2 id="运行结果"><a href="#运行结果" class="headerlink" title="运行结果"></a>运行结果</h2><p>运行Main.java，结果如下：</p>
<pre><code>User{id=1, name=&#39;letian&#39;, email=&#39;letian@111.com&#39;, password=&#39;123&#39;}
</code></pre><h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><p><a href="http://blog.csdn.net/huzheaccp/article/details/7399124" target="_blank" rel="external">MyBatis入门学习（一）</a></p>
<p><a href="http://www.cnblogs.com/daviddai/p/3485574.html" target="_blank" rel="external">一步步学Mybatis-搭建最简单的开发环境-开篇（1）</a></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://www.letiantian.me/2015-01-10-node-crawl-web-page-and-extract-links/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Letian">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/content/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="樂天笔记">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2015-01-10-node-crawl-web-page-and-extract-links/" itemprop="url">使用Node抓取网页并提取其中的链接</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2015-01-10T22:47:05+08:00">
                January 10th 2015
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>2015-01-10</p>
<p>node版本是<code>v0.10.28</code>。使用了3个第三方库，分别是<a href="https://github.com/request/request" target="_blank" rel="external">request</a>、<a href="https://github.com/ashtuchkin/iconv-lite" target="_blank" rel="external">iconv-lite</a>、<a href="https://github.com/cheeriojs/cheerio" target="_blank" rel="external">cheerio</a>。</p>
<h2 id="使用request获取网络内容"><a href="#使用request获取网络内容" class="headerlink" title="使用request获取网络内容"></a>使用request获取网络内容</h2><pre><code># !/usr/bin/env node
var request = require(&#39;request&#39;);

var options = {
    url: &#39;http://www.qq.com&#39;,
    headers: {
        &#39;User-Agent&#39;: &#39;request&#39;
    }
};

request(options,function(error, response, body) {
    if (!error &amp;&amp; response.statusCode == 200) {
        console.log(body);
    }
});
</code></pre><p>能够抓取网页内容，可惜内容乱码（<code>http://www.qq.com</code>编码为gb2312，上述代码所在文件为utf-8编码，而且Node当前貌似也不支持gb2312等编码。）。这里用iconv-lite对其进行转换。</p>
<h2 id="使用iconv-lite对获取的网页进行编码转换"><a href="#使用iconv-lite对获取的网页进行编码转换" class="headerlink" title="使用iconv-lite对获取的网页进行编码转换"></a>使用iconv-lite对获取的网页进行编码转换</h2><pre><code># !/usr/bin/env node
var iconv = require(&#39;iconv-lite&#39;);
var request = require(&#39;request&#39;);

iconv.extendNodeEncodings();

var options = {
    url: &#39;http://www.qq.com&#39;,
    encoding: &#39;gb2312&#39;,
    headers: {
        &#39;User-Agent&#39;: &#39;request&#39;
    }
};

request(options, function (error, response, body) {
        if (!error &amp;&amp; response.statusCode == 200) {
            console.log(body);
        }
    }
);
</code></pre><p>现在，抓取的网页内容就正常了。然后使用cheerio提取链接。</p>
<h2 id="使用cheerio提取链接"><a href="#使用cheerio提取链接" class="headerlink" title="使用cheerio提取链接"></a>使用cheerio提取链接</h2><pre><code># !/usr/bin/env node
var iconv = require(&#39;iconv-lite&#39;);
var request = require(&#39;request&#39;);
var cheerio = require(&#39;cheerio&#39;);

iconv.extendNodeEncodings();

var options = {
    url: &#39;http://www.qq.com&#39;,
    encoding: &#39;gb2312&#39;,
    headers: {
        &#39;User-Agent&#39;: &#39;request&#39;
    }
};

request(options, function (error, response, body) {
        if (!error &amp;&amp; response.statusCode == 200) {
            $ = cheerio.load(body);
            console.log($(&#39;a&#39;).length);
            $(&#39;a&#39;).each(function(i, elem) {
                title = $(this).text();
                url = $(this).attr(&#39;href&#39;);
                if (typeof(title) != &#39;undefined&#39; &amp;&amp; typeof(url) != &#39;undefined&#39;) {
                    console.log(title.trim());
                    console.log(url);
                }
            });
        }
    }
);
</code></pre><p>对链接的处理可以更细致一些。比如有一些url是<code>javascript:void(0)</code>，甚至有的是空串。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://www.letiantian.me/2015-01-04-create-ghost-theme/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Letian">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/content/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="樂天笔记">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2015-01-04-create-ghost-theme/" itemprop="url">Ghost博客主题制作简明教程</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2015-01-05T10:32:20+08:00">
                January 5th 2015
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>2015-01-04</p>
<p>-&gt; <a href="http://my.oschina.net/letiantian/blog/633055" target="_blank" rel="external">http://my.oschina.net/letiantian/blog/633055</a> 。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://www.letiantian.me/2014-12-23-nmf-pca-vq/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Letian">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/content/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="樂天笔记">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2014-12-23-nmf-pca-vq/" itemprop="url">比较NMF、PCA和VQ</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2014-12-23T19:15:13+08:00">
                December 23rd 2014
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>2014-12-23</p>
<hr>
<p>在下面的这篇论文里：</p>
<blockquote>
<p>Lee D D, Seung H S. Learning the parts of objects by non-negative matrix factorization[J]. Nature, 1999, 401(6755): 788-791.</p>
</blockquote>
<p>论文中使用了2429张人脸图像，每个图像大小是19×19=361。</p>
<p>以图像重建为例对比了NMF、PCA和VQ。</p>
<p>关于NMF：<a href="/2014-12-22-latent-factor-model-and-nmf/">隐语义模型和NMF（非负矩阵分解）</a></p>
<p>关于PCA：<a href="/2014-12-23-pca-mnist/">使用PCA处理MNIST数据集</a></p>
<p>VQ，全称Vector Quantization，可以翻译成“矢量量化”。在下面的两个博客里给出了很好的介绍：</p>
<p><a href="http://blog.pluskid.org/?p=57" target="_blank" rel="external">漫谈 Clustering (番外篇): Vector Quantization</a></p>
<p><a href="http://blog.csdn.net/zouxy09/article/details/9153255" target="_blank" rel="external">语音信号处理之（三）矢量量化（Vector Quantization）</a>  </p>
<h2 id="NMF"><a href="#NMF" class="headerlink" title="NMF"></a>NMF</h2><hr>
<p>NMF将非负矩阵V分解为两个非负矩阵的成绩，即W×H。设V的大小是n×m，W大小是n×r，H大小是r×m。这篇论文里，目标是最大化下面的式子：</p>
<p><img src="/content/images/2014/12/2014-12-23-nmf-pca-vq-01.jpg" alt=""></p>
<p>论文中给出下面的式子迭代更新W和H：</p>
<p><img src="/content/images/2014/12/2014-12-23-nmf-pca-vq-02.jpg" alt=""></p>
<p>使用论文中的图像数据集，W的大小为361×2429。r设置为49，所以W的大小为361×49，H的大小为49×2429。W的每一列可以构造出一个19×19的图像，但与PCA不同的是，它们是<code>parts-based representations</code>。于是由W可构造49张图片。H的第i列与图片数据集中的第i个图片对应。H(j, i)代表图像i针对图像<code>W（:, j）</code>的权重。这些权重都是非负的。</p>
<p>下图展示了某个图像在NMF下的重建结果：</p>
<p><img src="/content/images/2014/12/2014-12-23-nmf-pca-vq-03.jpg" alt=""></p>
<h2 id="VQ"><a href="#VQ" class="headerlink" title="VQ"></a>VQ</h2><hr>
<p>由于NMF中r=49，使用VQ时，将2429张人脸图像使用kmeans聚成49个簇，每个簇的所有图像求centroid，可以得到49个基本图像。重建某个人脸图像时，重建结果是该图像所属的簇的centroid对应的图像。</p>
<p>下图展示了某个图像（和上面的NMF使用同一个图像）在VQ下的重建结果：</p>
<p><img src="/content/images/2014/12/2014-12-23-nmf-pca-vq-04.jpg" alt=""></p>
<h2 id="PCA"><a href="#PCA" class="headerlink" title="PCA"></a>PCA</h2><hr>
<p>使用PCA将这些图像降到49维度，可以得到49个“特征脸”，对这49个“特征脸”加权求和可以得到一张“原始的脸”（原始图像）。</p>
<p>下图展示了某个图像（和上面的NMF使用同一个图像）在PCA下的重建结果：</p>
<p><img src="/content/images/2014/12/2014-12-23-nmf-pca-vq-05.jpg" alt=""></p>
<p>PCA与NMF的一个不同是PCA的权重有正有负。另外一点是，NMF构造的49张图像，每一张展示的是脸的部某分，每张图像是稀疏的；而PCA的每张“特征脸”都显示出了脸的轮廓。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://www.letiantian.me/2014-12-23-pca-mnist/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Letian">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/content/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="樂天笔记">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2014-12-23-pca-mnist/" itemprop="url">使用PCA处理MNIST数据集</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2014-12-23T15:42:04+08:00">
                December 23rd 2014
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>2014-12-23</p>
<h2 id="什么是PCA"><a href="#什么是PCA" class="headerlink" title="什么是PCA"></a>什么是PCA</h2><hr>
<p>假设要将n维空间中的数据降低到m维（m &lt; n）。首先在n维空间中找一个点作为m维空间的坐标原点<code>O</code>，然后找到m个n维的向量，这些向量的原点是<code>O</code>。将n维的数据对应的点投影到这m个向量上，可以将n维数据降低到m维。</p>
<p>设一个n维数据点X(i)，将其投影到m维空间后的点在n维空间的位置记为Y(i)。如果有k个n维的数据，PCA的目标是最小化下面的式子：</p>
<p>[latex]<br>\sum_{i=1}^{k} (X(i)-Y(i))^2<br>[/latex]</p>
<p>在一系列的计算后，扯到了协方差矩阵的特征值和特征向量上。</p>
<p>这就是PCA。</p>
<p><strong>补充：</strong>上面的式子叫做投影误差。PCA是将投影误差最小化。其实PCA也在最大化一个方差。这个方差是原始数据集在新的低维度空间对应的所有的数据点之间的方差。</p>
<h2 id="数据集准备"><a href="#数据集准备" class="headerlink" title="数据集准备"></a>数据集准备</h2><hr>
<p>在数据堂下载的<a href="http://www.datatang.com/data/44085" target="_blank" rel="external">手写数字数据集MNIST</a>，已经被预处理了。解压后可以找到<code>mnist_all.mat</code>，该文件存储了图片的数据。每个图片大小是28×28=784。</p>
<h2 id="用哪些图片呢？"><a href="#用哪些图片呢？" class="headerlink" title="用哪些图片呢？"></a>用哪些图片呢？</h2><hr>
<p>在Matlab中导入<code>mnist_all.mat</code>，然后：</p>
<pre><code>imgs = [train0(1:10, :); 
    train1(1:10, :);
    train2(1:10, :);
    train3(1:10, :);
    train4(1:10, :)];

imgs = im2double(imgs);

for i = 1:50
    subplot(5, 10, i);
    imshow(reshape(imgs(i, :), 28, 28));
end
</code></pre><p>效果如下：</p>
<p><img src="/content/images/2014/12/2014-12-23-mnist-pca-01.jpg" alt=""></p>
<p>每个图片大小为28×28=784，共有50张图片。故<code>imgs</code>大小为：</p>
<pre><code>&gt;&gt; size(imgs)

ans =

    50   784
</code></pre><h2 id="PCA一下"><a href="#PCA一下" class="headerlink" title="PCA一下"></a>PCA一下</h2><hr>
<pre><code>[coeff,score,latent] = pca(double(imgs));
size(coeff)
size(score)
latent
</code></pre><p>结果如下：</p>
<pre><code>ans =

   784    49


ans =

    50    49


latent =

   1.0e+05 *

    6.0345
    3.4149
    2.7540
    2.6989
    2.0999
    1.8697
    1.4234
    1.3323
    1.2419
    1.0725
    ...
    ...
</code></pre><p><code>latent</code>从大到小保存了样本协方差矩阵所有的特征值。<code>coeff</code>的每一列是样本协方差矩阵的特征向量（主成分分量），并与<code>latent</code>中的特征值一一对应。<code>score</code>第i行前n个数值代表着样本i降到n维的结果。在这个例子中，协方差矩阵共有49个特征值。</p>
<p><strong>取前两维，并可视化：</strong></p>
<pre><code>plot(score(1:10, 1), score(1:10, 2), &#39;r*&#39;);
hold on;
plot(score(11:20, 1), score(11:20, 2), &#39;g*&#39;);
hold on;
plot(score(21:30, 1), score(21:30, 2), &#39;b*&#39;);
hold on;
plot(score(31:40, 1), score(31:40, 2), &#39;go&#39;);
hold on;
plot(score(41:50, 1), score(41:50, 2), &#39;ro&#39;);
hold on;
</code></pre><p><img src="/content/images/2014/12/2014-12-23-mnist-pca-02.jpg" alt=""></p>
<p><strong>可视化“特征脸”</strong></p>
<p>“特征脸”这个词出现在使用PCA处理人脸数据集的相关文章中，在这里我借用一下。</p>
<p>主成分分量<code>coeff</code>大小为784×49，每一列可以构造一个“特征脸”。下面，对这些特征脸可视化：</p>
<pre><code>for i=1:49
    subplot(7, 7, i);
    imshow(reshape(coeff(:, i), 28, 28));
end
</code></pre><p>效果如下：</p>
<p><img src="/content/images/2014/12/2014-12-23-mnist-pca-03.jpg" alt=""></p>
<p>不太清楚，反转一下：</p>
<pre><code>for i=1:49
    subplot(7, 7, i);
    imshow(1.0 - reshape(coeff(:, i), 28, 28));
end
</code></pre><p>效果如下：</p>
<p><img src="/content/images/2014/12/2014-12-23-mnist-pca-04.jpg" alt=""></p>
<h3 id="重建图像"><a href="#重建图像" class="headerlink" title="重建图像"></a>重建图像</h3><p><code>score</code>第i行前n个数值代表着样本i降到n维的结果。score第i行的第j个数值代表着第j个“特征脸”在原图像i中的权重。这些权值有正有负，例如：</p>
<pre><code>&gt;&gt; score(:,1)

ans =

    4.0235
    4.2079
    3.3788
    4.3208
    6.4901
    4.3880
    5.7397
   -0.8090
    5.4659
    4.5928
   -3.3578
   -3.6533
   ...
   ...
</code></pre><p>据此，可以重构图像。下面以第一张图像为例。</p>
<p>计算样本均值：</p>
<pre><code>base_img =  mean(imgs);
imshow(reshape(base_img, 28, 28));
</code></pre><p>结果如下：</p>
<p><img src="/content/images/2014/12/2014-12-23-mnist-pca-05.jpg" alt=""></p>
<p>使用前2个“特征脸”重建第一个图片：</p>
<pre><code>base_img =  mean(imgs);
img = base_img&#39;;
for i = 1:2
    img = img + coeff(:, i).*score(1, i);
end
imshow(reshape(img, 28, 28));
</code></pre><p>结果如下：</p>
<p><img src="/content/images/2014/12/2014-12-23-mnist-pca-06.jpg" alt=""></p>
<p>使用前10个“特征脸”重建第一个图片，结果如下：</p>
<p><img src="/content/images/2014/12/2014-12-23-mnist-pca-07.jpg" alt=""></p>
<p>使用前30个“特征脸”重建第一个图片，结果如下：</p>
<p><img src="/content/images/2014/12/2014-12-23-mnist-pca-08.jpg" alt=""></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://www.letiantian.me/2014-12-22-latent-factor-model-and-nmf/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Letian">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/content/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="樂天笔记">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2014-12-22-latent-factor-model-and-nmf/" itemprop="url">隐语义模型和NMF（非负矩阵分解）</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2014-12-22T18:04:03+08:00">
                December 22nd 2014
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>2014-12-22</p>
<p>本文介绍了隐语义模型和NMF（非负矩阵分解）。</p>
<h2 id="隐语义模型"><a href="#隐语义模型" class="headerlink" title="隐语义模型"></a>隐语义模型</h2><hr>
<p>我当前是在推荐系统和文本分类中遇到过“隐语义模型”，也只是刚刚接触。那么，什么是隐语义模型？我们通过两个例子来理解一下。</p>
<h3 id="向用户推荐物品"><a href="#向用户推荐物品" class="headerlink" title="向用户推荐物品"></a>向用户推荐物品</h3><p>在推荐系统中，可以通过隐含语义模型将用户（user）和物品（item）自动分类，这些类别是自动生成的。这些类别也可以叫做“隐含的分类”，也许我们看不懂。每个用户或者物品会被分到多个类别中，属于某个类别的权重会被计算出来。</p>
<p>假设现在有一个大小为m×n的评分矩阵V，包含了m个用户对n个物品的评分，评分从0到5，值越大代表越喜欢，0代表没有打分。设定共有r个隐含的分类。通过一些方法，将V展开为两个相乘的矩阵：</p>
<pre><code>V = W*H
</code></pre><p>其中，W的大小为m×r，H的大小为r×n。在隐语义模型中，<code>W(i,j)</code>被解释为用户i属于类别j的权重，<code>H(a,b)</code>被解释为物品b属于类别a的的权重。</p>
<p>如果用户u对物品i没有评分，可以将这个评分r(u,i)预测为：</p>
<pre><code>r(u,i) = sum(W(i, :) .* H(:, i))  // 向量点乘
</code></pre><p>据此可以构建一个推荐系统。</p>
<h3 id="文本分类"><a href="#文本分类" class="headerlink" title="文本分类"></a>文本分类</h3><p>这个类似上面的推荐系统。我在<a href="http://www.letiantian.me/2014-12-12-bag-of-words-model-and-document-term-matrix/">词袋模型与文档-词矩阵</a>介绍过文档-词矩阵。我们将数据集中的一堆文本构造成文档-词矩阵V，如果共有m个文本，n个单词，那么V的大小为m×n。<code>V(i,j)</code>表示文档i中出现单词j的次数。</p>
<p>设定共有r个隐含的分类。通过一些方法，将V展开为两个相乘的矩阵：</p>
<pre><code>V = W*H
</code></pre><p>其中，W的大小为m×r，H的大小为r×n。在隐语义模型中，<code>W(i,j)</code>被解释为文档i属于类别j的权重，<code>H(a,b)</code>被解释为单词b属于类别a的的权重。</p>
<p>对于一个文档，其权重最大的类别被看作是该文档的类别。由于设定共有r个隐含的分类，分类结果也是r个份分类。</p>
<h2 id="NMF"><a href="#NMF" class="headerlink" title="NMF"></a>NMF</h2><hr>
<p>NMF，全称为non-negative matrix factorization，翻译为“非负矩阵分解”，可以用于隐语义模型。非负矩阵，就是矩阵中的每个元素都是非负的。将非负矩阵V分解为两个非负矩阵W和H的乘，叫做非负矩阵分解。那么，该怎么分解呢？在下面的这篇论文里，给出了两个方法并给出了证明。</p>
<blockquote>
<p>Lee D D, Seung H S. Algorithms for non-negative matrix factorization[C]//Advances in neural information processing systems. 2001: 556-562.</p>
</blockquote>
<h3 id="方法1"><a href="#方法1" class="headerlink" title="方法1"></a>方法1</h3><p>定义：</p>
<p>[latex]<br>||A-B||^2 = \sum_{ij}(A_{ij} - B_{ij})^2<br>[/latex]</p>
<p>目标是最小化[latex]||V-WH||^2[/latex]，初始化W和H后（可以将每个元素利用随机数初始化），按照下面的原则迭代更新W和H，直到W和H几乎不再变化，或者WH非常接近V。</p>
<p><img src="/content/images/2014/12/2014-12-22-nmf-00.jpg" alt=""></p>
<h3 id="方法2"><a href="#方法2" class="headerlink" title="方法2"></a>方法2</h3><p>定义：<br>[latex]<br>D(A||B) = \sum_{ij} (A_{ij} log\frac{A_{ij}}{B_{ij}} - A_{ij} + B_{ij})<br>[/latex]</p>
<p>当[latex]\sum_{ij}A_{ij} = \sum_{ij}B_{ij} = 1[/latex]时，上面的式子就退化成了<a href="http://zh.wikipedia.org/wiki/%E7%9B%B8%E5%AF%B9%E7%86%B5" target="_blank" rel="external">KL散度（或者叫相对熵）</a>。</p>
<p>这个方法的目标是最小化[latex]D(V||WH)[/latex]。初始化W和H后（可以将每个元素利用随机数初始化），按照下面的原则迭代更新W和H，直到W和H几乎不再变化，或者WH非常接近V。</p>
<p><img src="/content/images/2014/12/2014-12-22-nmf-01.jpg" alt=""></p>
<h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><p>项亮的《推荐系统实践》在第2章第5节提到了隐语义模型，并给出了一个基于梯度下降的矩阵分解方法（不是NMF）。</p>
<p>《集体智慧编程》第10章给出了NMF的浅显解释以及python实现。</p>
<p>下面的这篇论文探索了如何使用NMF进行文本分类：</p>
<blockquote>
<p>Xu W, Liu X, Gong Y. Document clustering based on non-negative matrix factorization[C]//Proceedings of the 26th annual international ACM SIGIR conference on Research and development in informaion retrieval. ACM, 2003: 267-273.</p>
</blockquote>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://www.letiantian.me/2014-12-22-google-404/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Letian">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/content/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="樂天笔记">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2014-12-22-google-404/" itemprop="url">解决谷歌索引404网页的问题</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2014-12-22T15:39:04+08:00">
                December 22nd 2014
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>2014-12-22</p>
<h2 id="问题"><a href="#问题" class="headerlink" title="问题"></a>问题</h2><p>静态博客的确很不错，也有很好的服务，比如github可以帮忙托管博客。我最开始是使用wordpress写博客，然后被静态博客的简洁（以及不用担心博客托管的费用和管理）所吸引，改用了hexo。使用了一段时间后，发现简洁的同时也给我带来了管理上的不简洁，之后改用ghost博客，同时url也基本都改变了。</p>
<p>如果请求的url不存在，Ghost会返回404页面，响应状态也是404。然而过去了2个月左右，我在google搜索“樂天笔记 atom”，第一条仍然是已经不存在的页面，这篇文章现在的地址是<a href="http://www.letiantian.me/2014-05-10-atom-editor/">http://www.letiantian.me/2014-05-10-atom-editor/</a>。</p>
<p><img src="/content/images/2014/12/2014-12-22-atom-01.png" alt=""></p>
<h2 id="怎么解决"><a href="#怎么解决" class="headerlink" title="怎么解决"></a>怎么解决</h2><p>谷歌站长工具支持删除url，但是一次只能删除一个，无法批量删除。在一个新闻组里也找到了类似的问题，回复中建议使用robots.txt来disallow不存在的url。我决定试一试。</p>
<h3 id="如何修改Ghost的robots-txt"><a href="#如何修改Ghost的robots-txt" class="headerlink" title="如何修改Ghost的robots.txt"></a>如何修改Ghost的robots.txt</h3><p>Ghost的默认robots.txt内容如下：</p>
<pre><code>User-agent: *
Disallow: /ghost/
</code></pre><p>在使用的主题目录下加上自己的robots.txt即可。</p>
<h3 id="如何找到不存在的url"><a href="#如何找到不存在的url" class="headerlink" title="如何找到不存在的url"></a>如何找到不存在的url</h3><p>hexo带有一个sitemap生成插件，可以用它来生成sitemap.xml，一般格式如下：</p>
<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;urlset xmlns=&quot;http://www.sitemaps.org/schemas/sitemap/0.9&quot;&gt;

    &lt;url&gt;
    &lt;loc&gt;http://letiantian.me/2014/10/04-asynchronous-requests/&lt;/loc&gt;
    &lt;lastmod&gt;2014-10-04T02:59:20.000Z&lt;/lastmod&gt;
    &lt;changefreq&gt;daily&lt;/changefreq&gt;
    &lt;/url&gt;

    &lt;url&gt;
    &lt;loc&gt;http://letiantian.me/about/index.html&lt;/loc&gt;
    &lt;lastmod&gt;2014-05-01T14:38:19.000Z&lt;/lastmod&gt;
    &lt;changefreq&gt;daily&lt;/changefreq&gt;
    &lt;/url&gt;
&lt;/urlset&gt;
</code></pre><p>了解格式后，要做的就是从sitemap.xml提取出所有的url、并删掉url中的<code>http://letiantian.me</code>。</p>
<p><strong>使用xml2js模块提取url：</strong></p>
<p>关于xml2js：<a href="https://www.npmjs.com/package/xml2js" target="_blank" rel="external">https://www.npmjs.com/package/xml2js</a>。</p>
<pre><code class="shell">$ npm install xml2js
</code></pre>
<pre><code># !/usr/bin/nodejs
var fs = require(&#39;fs&#39;),
xml2js = require(&#39;xml2js&#39;);

var parser = new xml2js.Parser();
fs.readFile(__dirname + &#39;/sitemap.xml&#39;,
    function(err, data) {
        parser.parseString(data,
            function(err,result) {
                urls = result.urlset.url;
                for (var i = 0; i &lt; urls.length; i++) {
                    console.log(urls[i].loc[0].replace(/http:\/\/letiantian.me/, &#39;&#39;));
                }
            }
        );
    }
);
</code></pre><p>结果：</p>
<pre><code>/2014/10/04-asynchronous-requests/
/about/index.html
/machine-learning/2014/09-21-affinity-propagation/
/machine-learning/2014/09-20-meanshift-clustering/
/machine-learning/2014/09-18-logistic-regression/
/machine-learning/2014/09-18-gradient-descent/
/algorithm/2014/09-17-float-string/
/2014/09/16-nginx-tornado/
/blogroll/index.html
/2014/09/08-find-repeating-elements-in-array/
/2014/09/08-latex-complie-references-warning/
/machine-learning/2014/09-07-k-medoids/
/2014/09/06-variance-and-covariance/
/hello-world/
/algorithm/2014/09-02-arrange-activity/
/2014/08/30-ruby-thread-join/
/algorithm/2014/08-24-shuffle-algorithm/
/algorithm/2014/08-24-reservoir-algorithm/
/2014/08/24-install-and-config-ruby/
/2014/08/22-modernize-website-of-college/
......
</code></pre><p>据此，改写robots.txt即可。</p>
<p>更进一步，去除cat和tag。</p>
<h2 id="等待结果"><a href="#等待结果" class="headerlink" title="等待结果"></a>等待结果</h2><p>我在2014-12-14这一天修改了robots.txt。</p>
<p>若干天后。。。。今天：<br><img src="/content/images/2014/12/2014-12-22-atom-02.png" alt=""></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://www.letiantian.me/2014-12-12-beautifulsoup-remove-js/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Letian">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/content/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="樂天笔记">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2014-12-12-beautifulsoup-remove-js/" itemprop="url">使用BeautifulSoup去除HTML中的JavaScript</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2014-12-12T16:15:50+08:00">
                December 12th 2014
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>2014-12-12</p>
<p>BeautifulSoup是一个处理html和xml的python库。<a href="http://www.crummy.com/software/BeautifulSoup/bs4/doc/index.zh.html" target="_blank" rel="external">这里</a>有一份它的中文文档。说到处理html和xml的python库，<a href="http://pythonhosted.org/pyquery/" target="_blank" rel="external">pyquery</a>也是个不错的选择。</p>
<p>使用下面的代码，可以去除html中的script标签以及标签之间的内容：</p>
<pre><code class="python"># -*- coding: utf-8 -*- 
from BeautifulSoup import BeautifulSoup

soup = BeautifulSoup(&#39;&lt;script&gt;a&lt;/script&gt;你好啊&lt;p&gt;hi&lt;/p&gt;&lt;script&gt;b&lt;/script&gt;&#39;)
for s in soup(&#39;script&#39;):
    s.extract()
print soup.__str__()
</code></pre>
<p>运行结果：</p>
<pre><code>你好啊&lt;p&gt;hi&lt;/p&gt;
</code></pre><p><strong>参考：</strong></p>
<p><a href="http://stackoverflow.com/questions/5598524/can-i-remove-script-tags-with-beautifulsoup" target="_blank" rel="external">Can I remove script tags with BeautifulSoup?</a>  </p>
<p><a href="http://stackoverflow.com/questions/964459/how-to-remove-text-between-script-and-script-using-python" target="_blank" rel="external">how to remove text between <code>&lt;</code>script<code>&gt;</code> and <code>&lt;</code>/script<code>&gt;</code>using python?</a></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://www.letiantian.me/2014-12-12-bag-of-words-model-and-document-term-matrix/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Letian">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/content/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="樂天笔记">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2014-12-12-bag-of-words-model-and-document-term-matrix/" itemprop="url">词袋模型与文档-词矩阵</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2014-12-12T11:51:28+08:00">
                December 12th 2014
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>2014-12-12</p>
<p>词袋模型：<a href="http://en.wikipedia.org/wiki/Bag-of-words_model" target="_blank" rel="external">Bag-of-words model</a>。</p>
<p>文档-词矩阵：<a href="http://en.wikipedia.org/wiki/Document-term_matrix" target="_blank" rel="external">Document-term matrix</a>。</p>
<p>可以这样认为：由词袋模型可以生成文档-词矩阵。</p>
<p>举个维基百科的例子：</p>
<p>在一个预料库(corpus)中有两个文档：</p>
<p>文档1内容如下：</p>
<pre><code>John likes to watch movies. Mary likes movies too.
</code></pre><p>文档2内容如下：</p>
<pre><code>John also likes to watch football games.
</code></pre><p>从这个语料库中可以找到10个单词，对每个单词进行编号，可以得到如下的字典：</p>
<pre><code>{
    &quot;John&quot;: 1,
    &quot;likes&quot;: 2,
    &quot;to&quot;: 3,
    &quot;watch&quot;: 4,
    &quot;movies&quot;: 5,
    &quot;also&quot;: 6,
    &quot;football&quot;: 7,
    &quot;games&quot;: 8,
    &quot;Mary&quot;: 9,
    &quot;too&quot;: 10
}
</code></pre><p>据此，可以将文档1转换成向量（下标从1开始）：</p>
<pre><code>V1 = [1, 2, 1, 1, 2, 0, 0, 0, 1, 1]
</code></pre><p>由于文档1中<code>John</code>出现了1次，<code>John</code>在字典中对应的值是1，所以<code>V1[1] = 1</code>。由于文档1中<code>to</code>出现了1次，<code>to</code>在字典中对应的值是3，所以<code>V1[3] = 1</code>。</p>
<p>同样的，可以将文档2转换成向量：</p>
<pre><code>V2 = [1, 1, 1, 1, 0, 1, 1, 1, 0, 0]
</code></pre><p>向量<code>V1</code>和<code>V2</code>可以构成文档-词矩阵M：</p>
<pre><code>1, 2, 1, 1, 2, 0, 0, 0, 1, 1
1, 1, 1, 1, 0, 1, 1, 1, 0, 0
</code></pre><p>在M中，<code>M[i][j]</code>代表在文档i中标号为j的单词的出现次数。</p>
<p><strong>补充：</strong></p>
<p>词袋模型不考虑词与词之间的先后顺序。</p>
<p>文档-词矩阵M中的值也可以由于0、1组成，1代表单词在文档中出现过，0代表没有出现过。</p>
<p>从语料库中构造字典，很多时候需要结合下面的技术：单词小写、词干提取、去除停止词，等等。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/5/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/5/">5</a><span class="page-number current">6</span><a class="page-number" href="/page/7/">7</a><span class="space">&hellip;</span><a class="page-number" href="/page/24/">24</a><a class="extend next" rel="next" href="/page/7/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel sidebar-panel-active">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/content/images/avatar.jpg"
               alt="Letian" />
          <p class="site-author-name" itemprop="name">Letian</p>
           
              <p class="site-description motion-element" itemprop="description"></p>
          
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives">
                <span class="site-state-item-count">209</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          

          
            
            
            <div class="site-state-item site-state-tags">
              <a href="/tags/index.html">
                <span class="site-state-item-count">43</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        
          <div class="feed-link motion-element">
            <a href="/atom.xml" rel="alternate">
              <i class="fa fa-rss"></i>
              RSS
            </a>
          </div>
        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/letiantian" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                  GitHub
                </a>
              </span>
            
          
        </div>

        
        

        
        

        


      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2017</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Letian</span>
</div>


<div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Pisces
  </a>
</div>


        
<div class="busuanzi-count">
  <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  
    <span class="site-uv">
      <i class="fa fa-user"></i>
      <span class="busuanzi-value" id="busuanzi_value_site_uv"></span>
      
    </span>
  

  
    <span class="site-pv">
      <i class="fa fa-eye"></i>
      <span class="busuanzi-value" id="busuanzi_value_site_pv"></span>
      
    </span>
  
</div>


        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.1"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.1"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.1"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.1"></script>



  


  




	





  
    
    <script>
      var cloudTieConfig = {
        url: document.location.href, 
        sourceId: "",
        productKey: "0b5e0b416d0b4d9a845ed9b2e72ddc70",
        target: "cloud-tie-wrapper"
      };
    </script>
    <script src="https://img1.ws.126.net/f2e/tie/yun/sdk/loader.js"></script>
  










  





  

  

  
  
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['[latex]','[/latex]'], ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        },
      });
    </script>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
      });
    </script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  


  

  


  <!-- highlight -->
  <script src="/highlight/highlight.min.js"></script>
  <link rel="stylesheet" href="/highlight/styles/github.css">

  <script>
    // 高亮
    hljs.initHighlightingOnLoad();
  </script>

</body>
</html>
